import{S as z,a as I,s as k,k as v,l as C,m as U,f as S,o as x,a2 as F,d as O,a9 as D,n as g}from"./index.32a30c8e.js";import{L as r}from"./leaflet.2cbba980.js";import"./leaflet.markercluster-src.77fb655c.js";import"./common.99c5149e.js";function E(a){let e,i,s;return{c(){e=v("div"),this.h()},l(l){e=C(l,"DIV",{class:!0,style:!0}),U(e).forEach(S),this.h()},h(){x(e,"class","w-full h-full relative z-10"),F(e,"background","linear-gradient(142deg,#085078 10%,#85d8ce)")},m(l,u){O(l,e,u),i||(s=D(a[0].call(null,e)),i=!0)},p:g,i:g,o:g,d(l){l&&S(e),i=!1,s()}}}function T(a){return a==0?"#fff":a>=40?"#eba500":a<=39&&a>=13?"#df5c15":a<=12?"#c01d0c":"#000"}function B(a){return{fillColor:T(a?.properties?.wwl_status),weight:1,opacity:1,color:"#aaa",fillOpacity:.9,zIndex:10}}function G(a,e,i){let{locale:s}=e,{countries:l}=e,{organizations:u}=e,{languages:m}=e,{t:d}=e,{countryWWL:y}=e,{countryShapes:c}=e;const w=new Intl.NumberFormat(s);async function _(n){let L={Agency:new r.Icon({iconUrl:"/images/map-pin-yellow.svg",iconSize:[16,26],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[20,20]}),UBS:new r.Icon({iconUrl:"/images/map-flag-green.svg",iconSize:[14,23],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[0,0]}),Library:new r.Icon({iconUrl:"/images/map-library-red.svg",iconSize:[16,18],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[20,20]}),FOBAI:new r.Icon({iconUrl:"/images/map-pin-blue1.svg",iconSize:[20,32],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[20,20]})};const W=new r.Icon({iconUrl:"/images/map-pin-green.svg",iconSize:[20,32],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[20,20]}),b=r.markerClusterGroup();u.forEach(t=>{if(t.latitude&&t.longitude){let o=r.marker([t.latitude,t.longitude],{icon:L[t.type]});o.bindPopup(`<a href="/${s}/organizations/${t.slug}">${t.name}</a>`),b.addLayer(o)}});const A=r.markerClusterGroup();m.forEach(t=>{if(t.latitude&&t.longitude){let o=r.marker([t.latitude,t.longitude],{icon:W});o.bindPopup(`<a href="/${s}/languages/${t.iso}">${t.name}</a>`),A.addLayer(o)}});for(let t=0;t<c.features.length;t++)i(1,c.features[t].properties.wwl_status=y.filter(o=>c.features[t].properties.iso_a2===o.country_id)[0]?.rank??0,c),i(1,c.features[t].properties.literacy=l.filter(o=>c.features[t].properties.iso_a2===o.id)[0]?.lit??100,c);let p=r.geoJson(c,{style:B});p.eachLayer(t=>{t.on("mouseover",function(){t.setStyle({fillOpacity:1}),t.bringToFront(),f.update(t.feature.properties)}),t.on("mouseout",function(){t.setStyle({fillOpacity:.9}),f.update()}),t.on("click",function(){window.location.href=`/${s}/countries/${t.feature.properties.iso_a2}`},this)});let h=r.map(n,{layers:[p]});h.setView([10,0],3);const f=r.control({position:"bottomleft"});return f.onAdd=function(t){return this._div=r.DomUtil.create("div","info"),this.update(),this._div},f.update=function(t){const o=t?`<b>${t.name}</b><br />${w.format(t.pop_est)} people,<br />
          ${w.format(t.literacy)}% Literacy Rate,<br /> ${t.wwl_status!=0?t.wwl_status+" World Watch List Rank":""}`:"";this._div.innerHTML=`<div class="p-2 bg-white/80 shadow rounded text-stone-900 empty:hidden">${o}</div>`},f.addTo(h),h.on("baselayerchange",function(t){let o=t.layer.options.style.toString();o.startsWith("function worldWatchListStyle")&&d?.world_watch_list,o.startsWith("function literacyListStyle")&&d?.literacy}),{destroy:()=>{h.remove()}}}return a.$$set=n=>{"locale"in n&&i(2,s=n.locale),"countries"in n&&i(3,l=n.countries),"organizations"in n&&i(4,u=n.organizations),"languages"in n&&i(5,m=n.languages),"t"in n&&i(6,d=n.t),"countryWWL"in n&&i(7,y=n.countryWWL),"countryShapes"in n&&i(1,c=n.countryShapes)},[_,c,s,l,u,m,d,y]}class j extends z{constructor(e){super(),I(this,e,G,E,k,{locale:2,countries:3,organizations:4,languages:5,t:6,countryWWL:7,countryShapes:1})}}export{j as default};
